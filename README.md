Using Cisco Netflow, easy to find the WIFI Router connected to catalyst

Every PC makes TCP connection with different source TCP ports.
The source ports of each PC are different with another PCs.
So, we can count PCs.

Below is the netflow example and we can extract the ports as like this:


############################################
example
############################################
python3 580-12.py
### interface= G1/0/ 1 tcp port numbers=  10 gap=  46641 max=  54804 min = 8163 avg=  18904 var=  321930387 std=  17943 
tcp ports are=  [8163, 8182, 8190, 10990, 11002, 11033, 11034, 11035, 54604, 54804]

PC 1 = 8163, 8182, 8190, 
PC 2 = 10990, 11002, 11033, 11034, 11035, 
PC 3 = 54604, 54804

#############################################
NETFLOW
#############################################

show flow monitor test3 cache format csv
  Cache type:                               Normal (Platform cache)
  Cache size:                                10000
  Current entries:                              48

  Flows added:                               10273
  Flows aged:                                10225
    - Active timeout      (  1800 secs)          3
    - Inactive timeout    (    15 secs)      10222

IPV4 SRC ADDR,TRNS SRC PORT,INTF INPUT,IP PROT
58.230.82.165,11033,Gi1/0/1,6
58.230.82.165,52643,Gi1/0/1,17
58.230.82.165,54259,Gi1/0/1,17
58.230.82.165,54604,Gi1/0/1,6
58.230.82.165,62314,Gi1/0/1,17
58.230.82.165,60321,Gi1/0/1,17
58.230.82.165,11035,Gi1/0/1,6
58.230.82.165,10990,Gi1/0/1,6
58.230.82.165,52107,Gi1/0/1,17
58.230.82.165,63846,Gi1/0/1,17
58.230.82.165,42481,Gi1/0/1,17
58.230.82.165,44422,Gi1/0/1,17
58.230.82.165,14949,Gi1/0/1,17
58.230.82.165,8163,Gi1/0/1,6
58.230.82.165,0,Gi1/0/1,1
58.230.82.165,55399,Gi1/0/1,17
58.230.82.165,8182,Gi1/0/1,6
58.230.82.165,52992,Gi1/0/1,17
58.230.82.165,11002,Gi1/0/1,6
58.230.82.165,63399,Gi1/0/1,17
58.230.82.165,51553,Gi1/0/1,17
58.230.82.165,61276,Gi1/0/1,17
58.230.82.165,11034,Gi1/0/1,6
58.230.82.165,60391,Gi1/0/1,17
58.230.82.165,53317,Gi1/0/1,17
58.230.82.165,8190,Gi1/0/1,6
58.230.82.165,57329,Gi1/0/1,17
58.230.82.165,51535,Gi1/0/1,17
58.230.82.165,62707,Gi1/0/1,17
58.230.82.165,56012,Gi1/0/1,17
58.230.82.165,49616,Gi1/0/1,17
58.230.82.165,51413,Gi1/0/1,17
58.230.82.165,52934,Gi1/0/1,17
58.230.82.165,0,Gi1/0/1,2
58.230.82.165,54804,Gi1/0/1,6
58.230.82.165,64582,Gi1/0/1,17

c9300#
